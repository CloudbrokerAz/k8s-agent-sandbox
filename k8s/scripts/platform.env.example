# Agent Sandbox Platform Configuration
# Source this file in deployment scripts or copy to .env for customization

# =============================================================================
# CLUSTER CONFIGURATION
# =============================================================================

# Kind cluster name (for local development)
KIND_CLUSTER_NAME="${KIND_CLUSTER_NAME:-sandbox}"

# Kubernetes context (leave empty to use current context)
KUBE_CONTEXT="${KUBE_CONTEXT:-}"

# =============================================================================
# NAMESPACE CONFIGURATION
# =============================================================================

# Agent sandbox namespace
DEVENV_NAMESPACE="${DEVENV_NAMESPACE:-devenv}"

# Vault namespace
VAULT_NAMESPACE="${VAULT_NAMESPACE:-vault}"

# Boundary namespace
BOUNDARY_NAMESPACE="${BOUNDARY_NAMESPACE:-boundary}"

# VSO namespace
VSO_NAMESPACE="${VSO_NAMESPACE:-vault-secrets-operator-system}"

# =============================================================================
# AGENT SANDBOX CONFIGURATION
# =============================================================================

# Number of agent sandbox replicas
DEVENV_REPLICAS="${DEVENV_REPLICAS:-1}"

# Build custom Docker image from Dockerfile.production (true/false)
# When true, builds the devcontainer with all tools pre-installed
# When false, uses a minimal ubuntu:22.04 image
BUILD_IMAGE="${BUILD_IMAGE:-true}"

# Docker registry for pushing images (leave empty for local/Kind clusters)
# Examples:
#   docker.io/yourusername
#   ghcr.io/yourusername
#   your-registry.azurecr.io
DOCKER_REGISTRY="${DOCKER_REGISTRY:-}"

# Image name and tag for the agent sandbox
IMAGE_NAME="${IMAGE_NAME:-agent-sandbox}"
IMAGE_TAG="${IMAGE_TAG:-latest}"

# Base image for agent sandbox (pre-built with Terraform, AWS CLI, Claude Code, etc.)
# This image is used directly when BUILD_IMAGE=false, or as the base for custom builds
BASE_IMAGE="${BASE_IMAGE:-srlynch1/terraform-ai-tools:latest}"

# Fallback image if BUILD_IMAGE is false or build fails (deprecated, use BASE_IMAGE)
DEVENV_IMAGE="${DEVENV_IMAGE:-srlynch1/terraform-ai-tools:latest}"

# Resource requests
DEVENV_CPU_REQUEST="${DEVENV_CPU_REQUEST:-250m}"
DEVENV_MEMORY_REQUEST="${DEVENV_MEMORY_REQUEST:-512Mi}"

# Resource limits
DEVENV_CPU_LIMIT="${DEVENV_CPU_LIMIT:-1000m}"
DEVENV_MEMORY_LIMIT="${DEVENV_MEMORY_LIMIT:-2Gi}"

# Storage size per pod
DEVENV_STORAGE_SIZE="${DEVENV_STORAGE_SIZE:-10Gi}"

# =============================================================================
# VAULT CONFIGURATION
# =============================================================================

# Vault image version
VAULT_IMAGE="${VAULT_IMAGE:-hashicorp/vault:1.15}"

# Enable secrets engines on init
VAULT_ENABLE_KV="${VAULT_ENABLE_KV:-true}"
VAULT_ENABLE_SSH="${VAULT_ENABLE_SSH:-true}"
VAULT_ENABLE_TERRAFORM="${VAULT_ENABLE_TERRAFORM:-true}"

# Vault storage size
VAULT_STORAGE_SIZE="${VAULT_STORAGE_SIZE:-5Gi}"

# =============================================================================
# BOUNDARY CONFIGURATION
# =============================================================================

# Boundary image version
BOUNDARY_IMAGE="${BOUNDARY_IMAGE:-hashicorp/boundary:0.17}"

# PostgreSQL storage size
BOUNDARY_POSTGRES_STORAGE="${BOUNDARY_POSTGRES_STORAGE:-5Gi}"

# =============================================================================
# VSO CONFIGURATION
# =============================================================================

# VSO Helm chart version (leave empty for latest)
VSO_CHART_VERSION="${VSO_CHART_VERSION:-}"

# Secret refresh interval
VSO_REFRESH_INTERVAL="${VSO_REFRESH_INTERVAL:-30s}"

# =============================================================================
# OPTIONAL FEATURES
# =============================================================================

# Deploy Boundary (true/false)
DEPLOY_BOUNDARY="${DEPLOY_BOUNDARY:-true}"

# Deploy Vault (true/false)
DEPLOY_VAULT="${DEPLOY_VAULT:-true}"

# Deploy VSO (true/false)
DEPLOY_VSO="${DEPLOY_VSO:-true}"

# =============================================================================
# TFE CONFIGURATION (for Terraform secrets engine)
# =============================================================================

# Terraform Cloud/Enterprise hostname
TFE_HOST="${TFE_HOST:-app.terraform.io}"

# TFE Organization (required for TFE engine)
TFE_ORG="${TFE_ORG:-}"

# TFE Team ID (for team token generation)
# Find this in TFE: Settings > Teams > [Team Name] > Team ID
TFE_TEAM_ID="${TFE_TEAM_ID:-}"

# =============================================================================
# SECRETS CONFIGURATION
# These secrets are stored in Vault KV and synced via VSO
# Set these before running configure-secrets.sh for non-interactive setup
# =============================================================================

# GitHub Personal Access Token
# Required scopes: repo, read:org, workflow
# Get from: https://github.com/settings/tokens
GITHUB_TOKEN="${GITHUB_TOKEN:-}"

# Langfuse Observability (optional)
# For LLM tracing and monitoring
LANGFUSE_HOST="${LANGFUSE_HOST:-}"
LANGFUSE_PUBLIC_KEY="${LANGFUSE_PUBLIC_KEY:-}"
LANGFUSE_SECRET_KEY="${LANGFUSE_SECRET_KEY:-}"

# AWS Credentials (optional, for Terraform AWS provider)
# These are passed directly to the container, not stored in Vault
AWS_ACCESS_KEY_ID="${AWS_ACCESS_KEY_ID:-}"
AWS_SECRET_ACCESS_KEY="${AWS_SECRET_ACCESS_KEY:-}"
AWS_SESSION_TOKEN="${AWS_SESSION_TOKEN:-}"

# =============================================================================
# DEBUGGING
# =============================================================================

# Enable verbose output
DEBUG="${DEBUG:-false}"
